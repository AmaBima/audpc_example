---
title: "AUDPC Analysis"
output: pdf_document
date: "July 5, 2016"
---

## Background

Stripe rust of wheat is caused by a basidiomycete pathogen called *Puccinia striiformis*.
Parallel lines of pustules form on the leaves of wheat plants, releasing enormous numbers of spores, especially when it is cool and humid.
Spores are dispersed by wind, sometimes very far, and infect more wheat or other grass hosts.
It can cause up to 40% loss of crop yields and seems to be adapting to warmer temperatures and resistant varieties of wheat.
*Puccinia striiformis* was first found in Australia but has since spread world wide.

## Analysis

I will be using data found on [this tutorial](http://www.apsnet.org/edcenter/advanced/topics/EcologyAndEpidemiologyInR/DiseaseProgress/Pages/StripeRust.aspx) to explore the effects of wheat cultivar and fungicide treatment on the incidence of disease caused by *Puccinia striiformis*.
 I will do this by comparing the **AUDPC** (area under disease progress curve) for the three cultivars and two fungicide treatments.

### Load packages

```{r, message = FALSE}
library('knitr')     # Used to make tables 
library('dplyr')     # Used for data.frame manipulations
library('tidyr')     # Used for data.frame manipulations
library('agricolae') # Used to calculated AUDPC
library('ggplot2')   # Used for graphing
library('magrittr')  # Adds %>% operator for chaining commands
```


### Parse input file

```{r}
data <- read.csv("fungicide_data.csv")
kable(data[, 1:3]) # make a table of first 3 columns
```


### Tidy up the data

```{r}
long_data <- data %>% 
  gather(cultivar, disease, -Julian.Date) %>% 
  mutate(fungicide = grepl(pattern = "\\.trt$", cultivar, ignore.case = TRUE)) %>% 
  transform(fungicide = ifelse(fungicide, "treated", "untreated")) %>% 
  transform(cultivar = gsub("\\.trt$", "", cultivar, ignore.case = TRUE)) 
kable(long_data[1:15, ]) # make a table of first 5 rows
```


### Graph the disease progress curves

The disease was first detected in all treatments on Julian day 140 (May 19) and continued to rise until the end of the study in all treatments.

```{r, echo = FALSE, fig.width=9}
dis_plot <- ggplot(long_data)
dis_plot <- dis_plot + geom_line(aes(x = Julian.Date, y = disease, linetype = cultivar))
dis_plot <- dis_plot + facet_wrap(~fungicide)
dis_plot <- dis_plot + theme_bw()
dis_plot <- dis_plot + labs(x = "Julian Day", y = "Percent Disease", title = "Disease Progress Curve")
dis_plot
```


### Calculate AUDPC

```{r}
audpc_data <- long_data %>% 
  group_by(cultivar, fungicide) %>% 
  summarize(AUDPC = audpc(disease, Julian.Date))
```

```{r, echo = FALSE}
audpc_data %>% 
  spread(fungicide, AUDPC) %>% # create a table with fungicide in columns and cultivar in rows
  arrange(untreated) %>%       # Sort by untreated
  kable()
```



### Graph AUDPC results

In general, "Jaggar" is the most susceptible and "Cutter" is the least.
The incidence of disease for all cultivars was less when treated with fungicides.

```{r, echo = FALSE, fig.width=9}
audpc_plot <- ggplot(audpc_data, aes(x = fungicide, y = AUDPC, fill = cultivar))
audpc_plot <- audpc_plot + geom_bar(stat = "identity", position = "dodge")
audpc_plot <- audpc_plot + theme_bw()
audpc_plot <- audpc_plot + labs(title = "Area Under the Disease Progress Curve")
# for color, uncomment the line below
# audpc_plot <- audpc_plot + scale_fill_brewer(type = "qual", palette = "Set1")
audpc_plot <- audpc_plot + scale_fill_grey()
audpc_plot
```


## Conclusions

In general, the AUDPC only changes between the fungicide treatments during the last 10 days of the experiment. 
The "Cutter" seemed to be most resistant to the disease followed by "2137" and "Jagger". 
The results suggest that the best yields will be obtained when "Cutter" wheat is used and it is treated with fungicide.
