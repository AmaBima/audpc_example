---
title: "AUDPC Analysis"
output: word_document
date: "July 5, 2016"
---

```{r echo = FALSE, message = FALSE}
library(knitr)
opts_chunk$set(echo = FALSE, message = FALSE, fig.width = 9)
```


## Background

Stripe rust of wheat is caused by a basidiomycete pathogen called *Puccinia striiformis*.
Parallel lines of pustules form on the leaves of wheat plants, releasing enormous numbers of spores, especially when it is cool and humid.
Spores are dispersed by wind, sometimes very far, and infect more wheat or other grass hosts.
It can cause up to 40% loss of crop yields and seems to be adapting to warmer temperatures and resistant varieties of wheat.
*Puccinia striiformis* was first found in Australia but has since spread world wide.

## Methods

I will be using data found on [this tutorial](http://www.apsnet.org/edcenter/advanced/topics/EcologyAndEpidemiologyInR/DiseaseProgress/Pages/StripeRust.aspx) to explore the effects of wheat cultivar and fungicide treatment on the incidence of disease caused by *Puccinia striiformis*.
 I will do this by comparing the **AUDPC** (area under disease progress curve) for the three cultivars and two fungicide treatments.
I will use R script called `audpc_code.R` to do the following:

1. Parse the file using `read.csv`
1. Tidy up the data using `reshape2` and `dplyr` functions
1. Graph the disease progress curves using `ggplot2`
1. Calculate AUDPC for each treatment
1. Graph AUDPC results


## Results

#### Disease progress curve

The disease was first detected in all treatments on Julian day 140 (May 19) and continued to rise until the end of the study in all treatments.

```{r}
library('dplyr')
library('tidyr')
library('agricolae')
library('knitr')
library('ggplot2')
library('magrittr')

data <- read.csv("fungicide_data.csv")

long_data <- data %>% 
  gather(cultivar, disease, -Julian.Date) %>% # gather by cultivar, call the new variable disease, and keep the Julian.Date column
  mutate(fungicide = grepl(pattern = "\\.trt$", cultivar, ignore.case = TRUE)) %>% # add fungicide column
  transform(fungicide = ifelse(fungicide, "treated", "untreated")) %>% # make it sensible
  transform(cultivar = gsub("\\.trt$", "", cultivar, ignore.case = TRUE)) # clean up the variable

# Creating a line graph of disease progress
g <- ggplot(long_data)
g <- g + geom_line(aes(x = Julian.Date, y = disease, linetype = cultivar))
g <- g + facet_wrap(~fungicide)
g <- g + theme_bw()
g <- g + labs(x = "Julian Day", y = "Percent Disease", title = "Disease Progress Curve")
g
```

#### AUDPC

In general, "Jaggar" is the most susceptible and "Cutter" is the least.
The incidence of disease for all cultivars was less when treated with fungicides.

```{r}
audpc_data <- long_data %>% 
  group_by(cultivar, fungicide) %>% 
  summarize(AUDPC = audpc(disease, Julian.Date)) 

# Creating a barplot for the AUDPC results
audpc_plot <- ggplot(audpc_data, aes(x = fungicide, y = AUDPC, fill = cultivar))
audpc_plot <- audpc_plot + geom_bar(stat = "identity", position = "dodge")
audpc_plot <- audpc_plot + theme_bw()
audpc_plot <- audpc_plot + labs(title = "AUDPC results")
# for color, uncomment the line below
# audpc_plot <- audpc_plot + scale_fill_brewer(type = "qual", palette = "Set1")
audpc_plot <- audpc_plot + scale_fill_grey()
audpc_plot
```


## Conclusions

In general, the AUDPC only changes between the fungicide treatments during the last 10 days of the experiment. 
The "Cutter" seemed to be most resistant to the disease followed by "2137" and "Jagger". 
The results suggest that the best yields will be obtained when "Cutter" wheat is used and it is treated with fungicide.
